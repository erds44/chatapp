(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{316:function(e,t,n){},317:function(e,t,n){},432:function(e,t,n){},439:function(e,t,n){},448:function(e,t,n){},450:function(e,t,n){},451:function(e,t,n){},459:function(e,t,n){},745:function(e,t,n){"use strict";n.r(t);var s=n(4),r=n(0),a=n(23),c=n.n(a),o=(n(316),n(317),n(103)),i=n(41),l=n(1),d=n(6),u=n(140),j=n(748),b=n(749),m=n(119),O=n(752),p=n(757),h=n(72),g=n(765),f=new WebSocket("ws://localhost:4567/chatapp"),x=n(20),y=n(760);y.b.config({duration:3,maxCount:5});var v={info:function(e){y.b.info({content:e},5)},success:function(e){y.b.success({content:e},5)},error:function(e){y.b.error({content:e},5)},warn:function(e){y.b.warn({content:e},5)}},S={labelCol:{span:4},wrapperCol:{span:20}},R={required:"${label} is required!"},I=Object(x.b)((function(e,t){return{logIn:e.login}}),{})((function(e){for(var t=Object(i.g)(),n=u.a.Option,a=[],c=[],o=["Traveling","Reading","Music","Sports","Movies","Games"],x=["Rice University","Duke University","USC","UCLA","New York University","Other"],y=(e.dispatch,e.logIn),I=j.a.useForm(),N=Object(d.a)(I,1)[0],C=(N.validateFields,0);C<x.length;C++)c.push(Object(s.jsx)(n,{value:x[C],children:x[C]}));for(var k=0;k<o.length;k++)a.push(Object(s.jsx)(n,{value:o[k],children:o[k]}));return Object(r.useEffect)((function(){console.log(y),y&&null!==y.isSignedIn&&(!0===y.isSignedIn?t.push("/chat"):v.error("The username already exists. Please choose another one!"))}),[y]),Object(s.jsx)(b.a,{title:"Login Chat Room",style:{width:"600px",margin:"80px auto"},headStyle:{fontSize:"30px",backgroundColor:"#d9d9d9"},bodyStyle:{backgroundColor:"#f5f5f5"},children:Object(s.jsxs)(j.a,Object(l.a)(Object(l.a)({},S),{},{name:"LoginForm",form:N,onFinish:function(e){console.log(e.user),f.send(JSON.stringify({command:"login",body:{name:e.user.name,age:e.user.age,school:e.user.school,interests:e.user.interests}}))},validateMessages:R,align:"left",children:[Object(s.jsx)(j.a.Item,{name:["user","name"],label:Object(s.jsxs)("span",{children:["Name\xa0",Object(s.jsx)(m.a,{title:"5-20 alphanumeric characters or underscores",children:Object(s.jsx)(g.a,{})})]}),rules:[{required:!0,message:"Name is required!"},{pattern:/^[a-zA-Z0-9_]{5,20}$/,message:"Name should be 5-20 alphanumeric characters or underscores"}],children:Object(s.jsx)(O.a,{placeholder:"Your Name"})}),Object(s.jsx)(j.a.Item,{name:["user","age"],label:"Age",rules:[{required:!0}],children:Object(s.jsx)(p.a,{min:0,max:200})}),Object(s.jsx)(j.a.Item,{name:["user","school"],label:"School",rules:[{required:!0}],children:Object(s.jsx)(u.a,{style:{width:"100%",textAlign:"left"},allowClear:!0,placeholder:"Please select your school",children:c})}),Object(s.jsx)(j.a.Item,{name:["user","interests"],label:"Interests",rules:[{required:!0}],children:Object(s.jsx)(u.a,{mode:"multiple",allowClear:!0,style:{width:"100%",textAlign:"left"},placeholder:"Please select your interests",children:a})}),Object(s.jsx)(j.a.Item,{wrapperCol:Object(l.a)(Object(l.a)({},S.wrapperCol),{},{offset:20}),children:Object(s.jsx)(h.a,{type:"primary",htmlType:"submit",size:"large",children:"Login"})})]}))})})),N=n(747),C=n(123),k=n(74),w=n(764),M=n(761),E=n(755),L=n(750),T=n(772),A=n(751),_=n(754),J=n(758),P=n(759),U=n(223),q=n.n(U),z=(n(432),["#355ca9","#2196f2","#5571bc","#fe5722","#43555f","#8665b6","#009688","#febf0a","#e81f63","#06a9f3","#03bcd3","#fe9800","#feea3b","#ccdb3a","#8bc24b","#4baf50","#22828d","#3f51b5","#9c26b0","#673ab7","#607d8b","#9e9e9e","#795548"]),D=[].concat(z),V={},F=function(e){return V[e]||(V[e]=function(){var e=D.shift();return e||(e=(D=[].concat(z)).shift()),e}()),V[e]},G="SIGN_IN",B="SIGN_OUT",H="ON_MESSAGE",K="DELETE_MESSAGE",W="EDIT_MESSAGE",Y="RECALL_MESSAGE",$="ON_MESSAGE_ERR",X="ROOM",Z="JOIN_ROOM",Q="ON_REPORT",ee="PRI_MESSAGE",te="SETALLUSERS",ne="EXIT_ROOM",se=["Sexual Content","Violent or repulsive content","Spam or misleading"],re="broadcast",ae=n(122),ce=n(298),oe=function(e){var t=e.message,n=e.onClickEdit,r=Object(x.c)(),a=t.id,c=t.text,o=t.time,i=t.sender,l=t.isRecalled,d=t.recallTime,u=t.received,j=Object(x.d)((function(e){return e.login.user})),b=Object(x.d)((function(e){return e.room.currentRoom})),m=(Object(x.d)((function(e){return e.room.userList})),Object(x.d)((function(e){return e.room})),Object(x.d)((function(e){return e.room.userList&&e.room.joinedRoom&&e.room.userList[e.room.joinedRoom.indexOf(b)]?e.room.userList[e.room.joinedRoom.indexOf(b)][0]:null}))),O=j===t.sender,p=j===m,g=i===m,y=Object(s.jsx)(_.a,{onClick:function(e){if(e&&e.key)switch(e.key){case"edit":n(t);break;case"delete":r({type:K,payload:{messageId:a,chatRoom:b}}),f.send(JSON.stringify({command:"deleteMessage",body:{messageId:a,chatRoom:b}}));break;case"recall":r({type:Y,payload:{messageId:a,chatRoom:b}}),f.send(JSON.stringify({command:"recallMessage",body:{messageId:a,chatRoom:b,recallTime:(new Date).getTime()}}))}},children:function(e,t){return t?["edit","delete","recall"]:e?["delete"]:[]}(p,O).map((function(e){return Object(s.jsx)(_.a.Item,{children:e},e)}))});return Object(s.jsxs)(C.a,{children:[Object(s.jsx)(k.a,{span:1,className:"avatar-container",children:Object(s.jsx)(J.a,{style:{backgroundColor:F(i),verticalAlign:"middle"},size:"large",gap:1,children:function(e){return e.split("_").map((function(e){return e[0]}))}(i)})}),Object(s.jsx)(k.a,{span:23,children:Object(s.jsxs)(C.a,{className:"".concat(null!==a&&void 0!==a?a:""," message-wrapper"),onMouseEnter:function(){var e=document.getElementById("".concat(a,"-dropdown"));e&&(e.style.visibility="visible",e.style.opacity="1")},onMouseLeave:function(){var e=document.getElementById("".concat(a,"-dropdown"));e&&(e.style.visibility="hidden",e.style.opacity="0")},children:[Object(s.jsxs)(k.a,{span:22,children:[Object(s.jsxs)(C.a,{className:"message-header",children:[Object(s.jsxs)(k.a,{className:"message-sender",children:[O?"ME":i," ",g&&" (admin)"]}),Object(s.jsxs)(k.a,{className:"message-time",children:[!l&&q()(o).format("ddd MMM DD hh:mm:ss"),u&&" (received)"]})]}),Object(s.jsx)(C.a,{children:Object(s.jsx)(k.a,{className:"message-text",children:Object(s.jsx)(ae.b,{content:!l&&c||function(e,t){return"******* This message was recalled at ".concat(q()(t).format("MMM DD hh:mm")," *******")}(0,d),matchers:[new ce.a("url")]})})})]}),Object(s.jsx)(k.a,{span:2,id:"".concat(a,"-dropdown"),className:"message-dropdown",children:!l&&(O||p)&&Object(s.jsx)(P.a,{overlay:y,placement:"bottomLeft",children:Object(s.jsx)(h.a,{children:"..."})})})]})})]})},ie=(n(439),function(e){return!e.toLowerCase().includes("hate")}),le=O.a.TextArea,de=function(e){var t=e.inputMessages,n=Object(x.c)(),a=Object(x.d)((function(e){return e.login.user})),c=Object(x.d)((function(e){return e.room.currentRoom})),o=Object(r.useState)(!1),i=Object(d.a)(o,2),l=i[0],u=i[1],j=Object(r.useState)(""),b=Object(d.a)(j,2),m=b[0],O=b[1],p=function(){u(!1);var e=document.getElementById("editMessageTextArea");if(ie(e.value)){var t={messageId:m.id,chatRoom:c,editedText:e.value};n({type:W,payload:t}),f.send(JSON.stringify({command:"editMessage",body:t}))}else f.send(JSON.stringify({command:"ban",body:{username:a.trim(),room:c.trim(),source:re}}))},h=function(e){O(e),u(!0)};return Object(s.jsxs)("article",{id:"chat-messages",children:[t&&t.map((function(e){return Object(s.jsx)(C.a,{className:"message",children:Object(s.jsx)(oe,{message:e,onClickEdit:h})})})),Object(s.jsx)(A.a,{title:"Edit Message",visible:l,onOk:p,onCancel:function(){return u(!1)},children:Object(s.jsx)(le,{id:"editMessageTextArea",rows:4,showCount:!0,defaultValue:null===m||void 0===m?void 0:m.text,onPressEnter:p})})]})},ue=n(312),je=(n(448),n(756)),be=(n(449),n(306)),me=n(766),Oe=O.a.TextArea,pe=function(){var e=Object(x.c)(),t=Object(x.d)((function(e){return e.login.user})),n=Object(x.d)((function(e){return e.room.currentRoom})),a=Object(r.useState)(""),c=Object(d.a)(a,2),o=c[0],i=c[1],u=Object(x.d)((function(e){return e.message.err_msg})),j=function(e){e.preventDefault(),o&&(ie(o)?u.length>0?v.error(u):b():f.send(JSON.stringify({command:"ban",body:{username:t.trim(),room:n.trim(),source:re}})),i(""))},b=function(){var s={chatRoom:n,text:o,id:je.a(),time:(new Date).getTime(),sender:t};e({type:H,payload:Object(l.a)(Object(l.a)({},s),{},{received:!0})}),f.send(JSON.stringify({command:"broadcast",body:s}))},m=Object(r.useState)(!1),O=Object(d.a)(m,2),p=O[0],g=O[1],y=Object(s.jsx)(be.a,{set:"twitter",perLine:12,include:["smileys","people"],onSelect:function(e){i(o+e.native)}});return Object(s.jsxs)("div",{id:"compose",children:[Object(s.jsx)(C.a,{children:Object(s.jsx)(Oe,{allowClear:!0,id:"compose-textarea",rows:4,value:o,showCount:!0,onPressEnter:j,onChange:function(e){i(e.target.value)}})}),Object(s.jsxs)(M.b,{style:{float:"right"},children:[Object(s.jsx)(ue.a,{content:y,trigger:"click",visible:p,onVisibleChange:function(){g(!p)},children:Object(s.jsx)(h.a,{children:Object(s.jsx)(me.a,{})})}),Object(s.jsx)(h.a,{onClick:j,children:"Send"})]})]})},he=(n(450),N.a.Content),ge=N.a.Footer,fe=(N.a.Header,function(e){var t=e.chatRoom,n=Object(x.d)((function(e){return e.message.messages})),a=Object(r.useState)(!1),c=Object(d.a)(a,2);c[0],c[1];return Object(r.useEffect)((function(){var e=document.querySelector("#chat-area-content");e.scrollTop>e.scrollHeight-1.5*e.clientHeight&&(e.scrollTop=e.scrollHeight-e.clientHeight)}),[n]),Object(s.jsx)("div",{id:"chat-area",children:Object(s.jsxs)(N.a,{children:[Object(s.jsx)(he,{id:"chat-area-content",children:Object(s.jsx)(de,{inputMessages:n[t]})}),Object(s.jsx)(ge,{children:Object(s.jsx)(pe,{})})]})})}),xe=n(762),ye=n(767),ve={labelCol:{span:8},wrapperCol:{span:16}},Se={required:"${label} is required!"},Re=function(e){for(var t=[],n=["Traveling","Reading","Music","Sports","Movies","Games"],a=u.a.Option,c=e.visible,o=e.setVisible,i=Object(r.useState)(!0),b=Object(d.a)(i,2),m=b[0],p=b[1],g=0;g<6;g++)t.push(Object(s.jsx)(a,{value:n[g],children:n[g]}));return Object(s.jsxs)(ue.a,{placement:"rightTop",title:"Create Room",content:Object(s.jsxs)(j.a,Object(l.a)(Object(l.a)({},ve),{},{name:"nest-messages",onFinish:function(e){f.send(JSON.stringify({command:"createRoom",body:{name:e.name,interests:e.interest,isPrivate:e.switch||!1}})),o(!1)},validateMessages:Se,style:{outerWidth:"500"},children:[Object(s.jsx)(j.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Name is required!"},{pattern:/^[a-zA-Z0-9_]{1,20}$/,message:"Name should be 1-20 alphanumeric characters or underscores"}],children:Object(s.jsx)(O.a,{})}),Object(s.jsx)(j.a.Item,{name:"switch",label:"Private",valuePropName:"checked",children:Object(s.jsx)(xe.a,{onClick:function(){p((function(e){return!e}))}})}),Object(s.jsx)(j.a.Item,{name:"interest",label:"Interests",rules:[{required:!m}],children:Object(s.jsx)(u.a,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",disabled:m,children:t})}),Object(s.jsx)(j.a.Item,{wrapperCol:Object(l.a)(Object(l.a)({},ve.wrapperCol),{},{offset:8}),children:Object(s.jsx)(h.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})),trigger:"click",visible:c,onVisibleChange:function(e){o(e)},children:[Object(s.jsx)("span",{children:Object(s.jsx)(ye.a,{})}),"Create"]})},Ie=n(763),Ne=n(768),Ce=_.a.SubMenu,ke=function(e){var t=1,n=Object(x.c)(),r=e.joinedRooms,a=e.userList,c=e.userName,o=e.setReport,i=function(e,n,r){return e===c||e===r?null:c===r?Object(s.jsx)(m.a,{title:"Remove",children:Object(s.jsx)(h.a,{style:{marginLeft:"5px"},ghost:"true",size:"small",type:"primary",shape:"circle",onClick:function(){return function(e,t){f.send(JSON.stringify({command:"forceToLeave",body:{userName:e,roomName:t}}))}(e,n)},children:"R"},e+"remove"+t++)}):Object(s.jsx)(m.a,{title:"Report",children:Object(s.jsx)(h.a,{style:{marginLeft:"5px"},ghost:"true",size:"small",type:"primary",shape:"circle",onClick:function(){o({visible:!0,reportRoom:n,reportName:e})},children:"!"},e+"report"+t++)})},l=function(e){return e!==c?Object(s.jsxs)(m.a,{title:"Block",children:[" ",Object(s.jsx)(h.a,{ghost:"true",size:"small",type:"primary",shape:"circle",onClick:function(){return function(e){f.send(JSON.stringify({command:"block",body:{userName:e}}))}(e)},children:"B"},e+"block"+t++)]}):null},d=function(e){var t=e.key;n({type:Z,payload:t})};return Object(s.jsx)(_.a,{mode:"inline",selectedKeys:[""],defaultOpenKeys:["joinedRooms"],children:Object(s.jsx)(Ce,{title:Object(s.jsxs)("span",{children:[Object(s.jsx)(Ne.a,{}),Object(s.jsx)("span",{children:"Joined Rooms"})]}),children:r.map((function(e,n){return Object(s.jsx)(Ce,{title:e,onTitleClick:d,children:a[n].map((function(e){var c=a[n][0]===e?"magenta":"green",o=a[n][0]===e?"Admin":"Member";return Object(s.jsxs)(_.a.Item,{children:[Object(s.jsx)(Ie.a,{color:c,children:o}),e,i(e,r[n],a[n][0]),l(e)]},e+t++)}))},e)}))},"joinedRooms")})},we=(n(769),_.a.SubMenu,n(770)),Me=function(){return Object(s.jsx)(_.a,{mode:"inline",selectedKeys:[""],onClick:function(){f.send(JSON.stringify({command:"exitAllRoom",body:{}}))},children:Object(s.jsxs)(_.a.Item,{children:[Object(s.jsx)("span",{children:Object(s.jsx)(we.a,{})}),"Exit All"]})})},Ee=n(771),Le=_.a.SubMenu,Te=function(e){var t=e.allRooms,n=e.isPublic;return Object(s.jsx)(_.a,{mode:"inline",onClick:function(e){var t;t=e,f.send(JSON.stringify({command:"joinRoom",body:{name:t.key}}))},defaultOpenKeys:["allRooms"],children:Object(s.jsx)(Le,{title:Object(s.jsxs)("span",{children:[Object(s.jsx)(Ne.a,{}),Object(s.jsx)("span",{children:"All Rooms"})]}),children:t.map((function(e,t){return Object(s.jsx)(_.a.Item,{children:Object(s.jsxs)("span",{children:["false"===n[t]?Object(s.jsx)("span",{children:Object(s.jsx)(Ee.a,{})}):null,e]})},e)}))},"allRooms")})},Ae=n(753),_e=(n(451),function(e){var t=Object(r.useState)(void 0),n=Object(d.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(""),i=Object(d.a)(o,2),u=i[0],j=i[1],b=Object(r.useState)(!0),m=Object(d.a)(b,2),p=m[0],h=m[1],g=e.report,x=e.setReport;return Object(s.jsx)("div",{children:Object(s.jsxs)(A.a,{title:"Report",visible:g.visible,onOk:function(){x(Object(l.a)(Object(l.a)({},g),{},{visible:!1})),f.send(JSON.stringify({command:"report",body:{reportedUsername:g.reportName,reportedReason:u,reportedRoom:g.reportRoom}}))},onCancel:function(){x(Object(l.a)(Object(l.a)({},g),{},{visible:!1}))},okButtonProps:{disabled:p},children:[Object(s.jsx)("p",{children:"Please Choose Your Reasons"}),Object(s.jsxs)(Ae.a.Group,{class:"radio-group",onChange:function(e){console.log("radio checked",e.target.value),h(!1),c(e.target.value),3!==e.target.value&&j(se[e.target.value])},value:a,children:[Object(s.jsx)(Ae.a,{class:"radio-option",value:0,children:se[0]}),Object(s.jsx)(Ae.a,{class:"radio-option",value:1,children:se[1]}),Object(s.jsx)(Ae.a,{class:"radio-option",value:2,children:se[2]}),Object(s.jsxs)(Ae.a,{class:"radio-option",value:3,children:["More...",3===a?Object(s.jsx)(O.a,{style:{width:100,marginLeft:10},onChange:function(e){console.log("input",e.target.value),3===a&&j(e.target.value)}}):null]})]})]})})}),Je=Object(x.b)((function(e,t){return{reportStore:e.report}}),{})((function(e){var t=e.reportStore,n=t.isReportAdminVisible,a=t.reportedReason,c=t.reportedUsername,o=t.reportedRoom,i=Object(r.useState)(!1),l=Object(d.a)(i,2),u=l[0],j=l[1];Object(r.useEffect)((function(){j(n)}),[e.reportStore]);return Object(s.jsx)("div",{children:Object(s.jsxs)(A.a,{title:"Handle Report Message",visible:u,onOk:function(e){j(!1),f.send(JSON.stringify({command:"ban",body:{username:c.trim(),room:o.trim(),source:"report"}}))},onCancel:function(e){j(!1)},okText:"Approve",cancelText:"Disapprove",children:[Object(s.jsxs)("p",{children:["Reported User: ",c]}),Object(s.jsx)("p",{children:a})]})})})),Pe=Object(x.b)((function(e,t){return{room:e.room}}),{})((function(e){var t=e.room,n=Object(r.useState)([]),a=Object(d.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)((function(){return[[]]})),l=Object(d.a)(i,2),u=l[0],j=l[1],b=Object(r.useState)((function(){return[]})),m=Object(d.a)(b,2),O=m[0],p=m[1],h=Object(r.useState)(!1),g=Object(d.a)(h,2),f=g[0],x=g[1],y=Object(r.useState)(),S=Object(d.a)(y,2),R=S[0],I=S[1],N=Object(r.useState)((function(){return[]})),C=Object(d.a)(N,2),k=C[0],w=C[1],M=Object(r.useState)({visible:!1,reportRoom:null,reportName:null}),E=Object(d.a)(M,2),L=E[0],T=E[1];return Object(r.useEffect)((function(){null==t.msg?(t.joinedRoom&&o(t.joinedRoom),t.userList&&j(t.userList),t.allRooms&&p(t.allRooms),t.userName&&I(t.userName),t.isPublic&&w(t.isPublic)):"err"===t.type?v.error(t.msg):"info"===t.type?v.info(t.msg):v.success(t.msg)}),[t]),Object(s.jsxs)(_.a,{mode:"inline",onClick:function(e){"create"===e.key&&x(!0)},selectedKeys:[""],defaultOpenKeys:["allRooms","joinedRooms"],children:[Object(s.jsx)(_.a.Item,{children:Object(s.jsx)(Re,{visible:f,setVisible:x})},"create"),Object(s.jsx)(Me,{}),Object(s.jsx)(ke,{joinedRooms:c,userList:u,userName:R,setReport:T}),Object(s.jsx)(Te,{allRooms:O,isPublic:k}),Object(s.jsx)(_e,{report:L,setReport:T}),Object(s.jsx)(Je,{})]})})),Ue=function(e){var t=Object(r.useState)(""),n=Object(d.a)(t,2),a=n[0],c=n[1],o=e.userName,i=e.visible,l=e.setVisible,u=O.a.TextArea,j=Object(x.d)((function(e){return e.login.user}));return Object(s.jsx)(A.a,{title:"To ".concat(o),visible:i,onOk:function(){ie(a)?f.send(JSON.stringify({command:"privateMessage",body:{name:o,info:a}})):f.send(JSON.stringify({command:"ban",body:{username:j.trim(),room:null,source:"privateMsg"}})),c(""),l(!1)},onCancel:function(){c(""),l(!1)},children:Object(s.jsx)(u,{value:a,onChange:function(e){var t=e.target.value;c(t)}})})},qe=function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(""),i=Object(d.a)(o,2),l=i[0],u=i[1],j=Object(x.d)((function(e){return e.userList.allUserList})),b=Object(x.d)((function(e){return e.login.user}));return console.log(b),Object(s.jsxs)("div",{children:[Object(s.jsx)(Ue,{userName:l,visible:a,setVisible:c}),Object(s.jsx)(L.b,{style:{width:"100%",height:"100%",position:"absolute",overflow:"auto"},itemLayout:"horizontal",dataSource:j,renderItem:function(e){return Object(s.jsxs)(L.b.Item,{style:{padding:"15px"},children:[Object(s.jsx)(L.b.Item.Meta,{avatar:Object(s.jsx)(J.a,{style:{backgroundColor:F(e.name),verticalAlign:"middle"},size:"large",gap:1,children:(t=e.name,t.split("_").map((function(e){return e[0]})))}),description:e.name,title:e.school}),e.name!=b?Object(s.jsx)(h.a,{type:"primary",shape:"round",size:"small",onClick:function(){u(e.name),c(!0)},children:"Chat!"}):Object(s.jsx)(h.a,{type:"primary",shape:"round",size:"small",disabled:!0,children:"Chat!"})]});var t}})]})},ze=Object(x.b)((function(e,t){return{rooms:e.room}}),{})((function(e){var t=e.selectedChatRoom,n=e.rooms,a=Object(r.useState)(""),c=Object(d.a)(a,2),o=c[0],i=c[1],l=Object(r.useState)([]),u=Object(d.a)(l,2),j=(u[0],u[1]),b=Object(x.d)((function(e){return e.login.user})),m=Object(r.useState)(!1),p=Object(d.a)(m,2),g=p[0],y=p[1];Object(r.useEffect)((function(){null==n.msg&&n.joinedRoom&&j(n.joinedRoom)}),[n]);var v=Object(s.jsxs)(M.b,{align:"center",children:[Object(s.jsx)(O.a,{placeholder:"Username",onChange:function(e){i(e.target.value)}}),Object(s.jsx)(h.a,{type:"primary",onClick:function(){return e=t,n=o,y(!1),void(null!=e&&null!=n&&f.send(JSON.stringify({command:"invite",body:{currentUser:b,inviteUserName:n,invitedRoom:e}})));var e,n},children:"Invite"})]});return Object(s.jsx)(ue.a,{content:v,title:"Invite your friend!",trigger:"click",visible:g,onVisibleChange:function(e){y(e)},children:Object(s.jsx)(h.a,{children:"Invite"})})})),De=(n(459),N.a.Header),Ve=N.a.Content,Fe=N.a.Footer,Ge=N.a.Sider,Be=Object(x.b)((function(e,t){return{logIn:e.login,priMsg:e.priMessage}}),{})((function(e){Object(i.g)(),e.dispatch,e.logIn;var t,n=e.priMsg,a=Object(x.d)((function(e){return e.room.currentRoom})),c=Object(r.useState)(!1),o=Object(d.a)(c,2),l=o[0],u=o[1],j=Object(r.useState)(!1),b=Object(d.a)(j,2),m=b[0],O=b[1],p=Object(x.c)(),g=Object(r.useState)(""),y=Object(d.a)(g,2),S=y[0],R=y[1],I=Object(x.d)((function(e){return e.room.userList&&e.room.joinedRoom?e.room.userList[e.room.joinedRoom.indexOf(a)]:null})),A=Object(x.d)((function(e){return e.login.user})),_=Object(x.d)((function(e){return e.userList.allUserList})).find((function(e){return e.name===A}));if(void 0!=_){for(var J="",P=0;P<_.interest.length;P++)P>0&&(J+=", "),J+=_.interest[P];t=[{title:"Name",description:_.name},{title:"Age",description:_.age},{title:"School",description:_.school},{title:"Interests",description:J}]}var U=function(e,t){return Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{className:"message",children:e}),Object(s.jsx)("div",{className:"message",children:Object(s.jsx)(h.a,{onClick:function(){return q(t)},children:"Reply"})})]})},q=function(e){R(e),u(!0)};return Object(r.useEffect)((function(){null!==n.message?w.a.info({message:"".concat(n.sender," sends you a message"),description:U(n.message.info,n.sender),duration:5,styles:{paddingTop:"10px"}}):null!==n.feedback&&(n.feedback.indexOf("Sorry")<0?v.success(n.feedback):v.error(n.feedback))}),[n]),Object(s.jsxs)(N.a,{style:{height:"100vh"},children:[Object(s.jsx)(Ue,{userName:S,visible:l,setVisible:u}),Object(s.jsx)(Ge,{width:"300px",theme:"light",style:{overflowY:"auto"},children:Object(s.jsx)(Pe,{})}),Object(s.jsxs)(N.a,{style:{overFlow:"hidden"},children:[Object(s.jsxs)(De,{style:{padding:0,backgroundColor:"white"},children:[a&&Object(s.jsx)("span",{id:"chat-area-header-room-name",style:{fontSize:"larger",fontWeight:"bolder"},children:a||""}),a&&Object(s.jsx)("span",{id:"chat-area-header-user-count",style:{fontSize:"medium",marginLeft:"20px"},children:I&&"(".concat(I.length,")")||""}),Object(s.jsxs)(M.b,{style:{float:"right"},size:"middle",children:[Object(s.jsx)("div",{children:null!=a?Object(s.jsxs)(s.Fragment,{children:[" ",Object(s.jsx)(h.a,{className:"exitButton",onClick:function(){p({type:ne,payload:null}),f.send(JSON.stringify({command:"exitRoom",body:{name:a}}))},children:"Exit"}),Object(s.jsx)(ze,{selectedChatRoom:a})," "]}):null}),Object(s.jsx)(h.a,{type:"primary",shape:"circle",icon:Object(s.jsx)(T.a,{}),onClick:function(){O(!0)}}),Object(s.jsxs)(E.a,{title:"User Profile",placement:"left",closable:!1,onClose:function(){O(!1)},visible:m,children:[Object(s.jsx)(L.b,{itemLayout:"horizontal",dataSource:t,renderItem:function(e){return Object(s.jsx)(L.b.Item,{children:Object(s.jsx)(L.b.Item.Meta,{title:e.title,description:e.description})})}}),Object(s.jsx)(h.a,{type:"primary",shape:"round",size:"small",onClick:function(){f.send(JSON.stringify({command:"logout",body:{}}))},children:"Logout"})]})]})]}),Object(s.jsx)(Ve,{style:{margin:"24px 16px 0"},children:Object(s.jsxs)(C.a,{style:{height:"100%"},children:[Object(s.jsx)(k.a,{span:17,children:Object(s.jsx)("div",{className:"site-layout-background",style:{minHeight:360,height:"100%"},children:a&&Object(s.jsx)(fe,{chatRoom:a})})}),Object(s.jsx)(k.a,{span:7,style:{borderLeft:"2px solid rgba(0, 0, 0, 0.06)"},children:qe()})]})}),Object(s.jsx)(Fe,{style:{textAlign:"center"},children:"Chat App \xa92020 Created by Sammy the Owl"})]})]})})),He=n(302),Ke=(n(225),0),We=n(18),Ye=Object(x.b)((function(e){return{logInStore:e.login}}),{})((function(e){var t=e.component,n=Object(We.a)(e,["component"]);return Object(s.jsx)(i.b,Object(l.a)(Object(l.a)({},n),{},{render:function(){return n.logInStore.isSignedIn?Object(s.jsx)(t,{}):Object(s.jsx)(i.a,{to:{pathname:"/"}})}}))})),$e=Object(He.a)(),Xe=Object(x.b)((function(e,t){return{message:e.message}}),{onMessage:function(e){return function(t){var n=JSON.parse(e.data);switch(n.section){case"login":"err"===n.type?t({type:G,payload:{mesId:Ke++,isSignedIn:!1,user:null,msg:n.msg}}):t({type:G,payload:{mesId:Ke++,isSignedIn:!0,user:n.msg,msg:n.msg}});break;case"logout":t({type:B,payload:{mesId:Ke++,isSignedIn:!1,user:null,msg:n.msg}});break;case"room":t({type:X,payload:{request:n.request,type:n.type,msg:n.msg,param1:n.param1,param2:n.param2,param3:n.param3,param4:n.param4,param5:n.param5}});break;case"report":var s=JSON.parse(n.msg);t({type:Q,payload:{reportedUsername:s.reportedUsername,reportedReason:s.reportedReason,reportedRoom:s.reportedRoom}});break;case"message":if("ON_MESSAGE_ERR"===n.request)return void t({type:$,payload:{err_msg:n.msg}});t({type:n.request,payload:JSON.parse(n.msg)});break;case"privateMessage":if("priMsg_feedback"===n.request){t({type:ee,payload:null,sender:null,feedback:n.msg});break}var r=n.request;t({type:ee,payload:JSON.parse(n.msg),sender:r,feedback:null});break;case"setallusers":t({type:te,payload:JSON.parse(n.msg)})}}}})((function(e){e.dispatch,e.message;return f.onopen=function(){console.log("connected")},f.onmessage=function(t){console.log(t),e.onMessage(t)},f.onclose=function(){A.a.error({content:"Websocket disconnected, please reenter the chat app"})},Object(s.jsx)("div",{className:"App",children:Object(s.jsx)(o.a,{history:$e,children:Object(s.jsxs)(i.d,{children:[Object(s.jsx)(i.b,{path:"/",exact:!0,component:I}),Object(s.jsx)(Ye,{path:"/chat",exact:!0,component:Be})]})})})})),Ze=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,773)).then((function(t){var n=t.getCLS,s=t.getFID,r=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),s(e),r(e),a(e),c(e)}))},Qe=n(97),et=n(303),tt=(n(240),{isSignedIn:null,user:null,mesId:0,msg:null}),nt={messages:{},err_msg:""},st={allUserList:[]},rt=(n(742),{request:null,type:null,msg:null,currentRoom:null,joinedRoom:[],userList:[[]],allRooms:[],isPublic:[]}),at=function(e){return e?"[]"===e?[]:e.substring(1,e.length-1).split(", "):null},ct=function(e,t){if(t){if("[]"===t)return[];for(var n=at(e).length,s=[],r=t.substring(1,t.length-1),a=0;a<n;a++){var c=r.indexOf("["),o=r.indexOf("]"),i=r.substring(c+1,o).split(", ");s.push(i),r=r.substring(o+1)}return s}return null},ot={isReportAdminVisible:!1,reportedUsername:"",reportedReason:"",reportedRoom:""},it={message:null,sender:null,feedback:null},lt=Object(Qe.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return!0===t.payload.isSignedIn?Object(l.a)(Object(l.a)({},e),{},{isSignedIn:!0,user:t.payload.user,mesId:t.payload.mesId,msg:t.payload.msg}):Object(l.a)(Object(l.a)({},e),{},{isSignedIn:!1,user:null,mesId:t.payload.mesId,msg:t.payload.msg});case B:return Object(l.a)(Object(l.a)({},e),{},{isSignedIn:null,user:null,mesId:t.payload.mesId,msg:t.payload.msg});default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return console.log("kfkkf",t.payload.err_msg),{err_msg:t.payload.err_msg,messages:{}};case H:var n=e.messages,s=t.payload,r=s.id,a=s.text,c=s.time,o=s.sender,i=s.chatRoom,d=s.received;return n[i]||(n[i]=[]),n[i].push({id:r,text:a,time:c,sender:o,received:d}),Object(l.a)(Object(l.a)({},e),{},{messages:Object(l.a)({},n)});case K:var u=e.messages,j=t.payload,b=j.messageId,m=j.chatRoom,O=u[m].filter((function(e){return e.id!==b})),p=Object(l.a)({},u);return p[m]=O,Object(l.a)(Object(l.a)({},e),{},{messages:p});case Y:var h=e.messages,g=t.payload,f=g.messageId,x=g.chatRoom,y=g.recallTime,v=h[x].map((function(e){return e.id===f&&(e.isRecalled=!0,e.recallTime=y,e.text=""),e})),S=Object(l.a)({},h);return S[x]=v,Object(l.a)(Object(l.a)({},e),{},{messages:S});case W:var R=e.messages,I=t.payload,N=I.messageId,C=I.chatRoom,k=I.editedText,w=R[C].map((function(e){return e.id===N&&(e.text=k),e})),M=Object(l.a)({},R);return M[C]=w,Object(l.a)(Object(l.a)({},e),{},{messages:M});default:return e}},userList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case te:return console.log(t.payload),Object(l.a)(Object(l.a)({},e),{},{allUserList:t.payload});default:return e}},room:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:var n=e.currentRoom;return"[]"===t.payload.param1&&(n=null),{request:t.payload.request,type:t.payload.type,msg:t.payload.msg,joinedRoom:at(t.payload.param1)||e.joinedRoom,userList:ct(t.payload.param1,t.payload.param2)||e.userList,allRooms:at(t.payload.param3)||e.allRooms,userName:t.payload.param4||e.userName,isPublic:at(t.payload.param5)||e.isPublic,currentRoom:n};case Z:case ne:return Object(l.a)(Object(l.a)({},e),{},{msg:null,currentRoom:t.payload});default:return e}},report:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return Object(l.a)(Object(l.a)({},e),{},{isReportAdminVisible:!0,reportedReason:t.payload.reportedReason,reportedUsername:t.payload.reportedUsername,reportedRoom:t.payload.reportedRoom});default:return e}},priMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:return Object(l.a)(Object(l.a)({},e),{},{sender:t.sender,message:t.payload,feedback:t.feedback});case B:return Object(l.a)(Object(l.a)({},e),it);default:return e}}}),dt=(n(744),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Qe.d),ut=Object(Qe.e)(lt,dt(Object(Qe.a)(et.a)));c.a.render(Object(s.jsx)(x.a,{store:ut,children:Object(s.jsx)(Xe,{})}),document.getElementById("root")),Ze()}},[[745,1,2]]]);
//# sourceMappingURL=main.d605c4d9.chunk.js.map