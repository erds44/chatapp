(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{316:function(e,t,n){},317:function(e,t,n){},432:function(e,t,n){},439:function(e,t,n){},448:function(e,t,n){},450:function(e,t,n){},451:function(e,t,n){},459:function(e,t,n){},745:function(e,t,n){"use strict";n.r(t);var s=n(4),a=n(0),r=n(23),c=n.n(r),o=(n(316),n(317),n(103)),i=n(41),l=n(1),d=n(6),u=n(140),j=n(748),b=n(749),m=n(119),O=n(752),p=n(757),h=n(72),g=n(765),f=new WebSocket("ws://localhost:4567/chatapp"),x=n(21),y=n(760);y.b.config({duration:3,maxCount:5});var v={info:function(e){y.b.info({content:e},5)},success:function(e){y.b.success({content:e},5)},error:function(e){y.b.error({content:e},5)},warn:function(e){y.b.warn({content:e},5)}},S={labelCol:{span:4},wrapperCol:{span:20}},R={required:"${label} is required!"},I=Object(x.b)((function(e,t){return{logIn:e.login}}),{})((function(e){for(var t=Object(i.g)(),n=u.a.Option,r=[],c=[],o=["Traveling","Reading","Music","Sports","Movies","Games"],x=["Rice University","Duke University","USC","UCLA","New York University","Other"],y=(e.dispatch,e.logIn),I=j.a.useForm(),C=Object(d.a)(I,1)[0],N=(C.validateFields,0);N<x.length;N++)c.push(Object(s.jsx)(n,{value:x[N],children:x[N]}));for(var k=0;k<o.length;k++)r.push(Object(s.jsx)(n,{value:o[k],children:o[k]}));return Object(a.useEffect)((function(){console.log(y),y&&null!==y.isSignedIn&&(!0===y.isSignedIn?t.push("/chat"):v.error("The username already exists. Please choose another one!"))}),[y]),Object(s.jsx)(b.a,{title:"Login Chat Room",style:{width:"600px",margin:"80px auto"},headStyle:{fontSize:"30px",backgroundColor:"#d9d9d9"},bodyStyle:{backgroundColor:"#f5f5f5"},children:Object(s.jsxs)(j.a,Object(l.a)(Object(l.a)({},S),{},{name:"LoginForm",form:C,onFinish:function(e){console.log(e.user),f.send(JSON.stringify({command:"login",body:{name:e.user.name,age:e.user.age,school:e.user.school,interests:e.user.interests}}))},validateMessages:R,align:"left",children:[Object(s.jsx)(j.a.Item,{name:["user","name"],label:Object(s.jsxs)("span",{children:["Name\xa0",Object(s.jsx)(m.a,{title:"5-20 alphanumeric characters or underscores",children:Object(s.jsx)(g.a,{})})]}),rules:[{required:!0,message:"Name is required!"},{pattern:/^[a-zA-Z0-9_]{5,20}$/,message:"Name should be 5-20 alphanumeric characters or underscores"}],children:Object(s.jsx)(O.a,{placeholder:"Your Name"})}),Object(s.jsx)(j.a.Item,{name:["user","age"],label:"Age",rules:[{required:!0}],children:Object(s.jsx)(p.a,{min:0,max:200})}),Object(s.jsx)(j.a.Item,{name:["user","school"],label:"School",rules:[{required:!0}],children:Object(s.jsx)(u.a,{style:{width:"100%",textAlign:"left"},allowClear:!0,placeholder:"Please select your school",children:c})}),Object(s.jsx)(j.a.Item,{name:["user","interests"],label:"Interests",rules:[{required:!0}],children:Object(s.jsx)(u.a,{mode:"multiple",allowClear:!0,style:{width:"100%",textAlign:"left"},placeholder:"Please select your interests",children:r})}),Object(s.jsx)(j.a.Item,{wrapperCol:Object(l.a)(Object(l.a)({},S.wrapperCol),{},{offset:20}),children:Object(s.jsx)(h.a,{type:"primary",htmlType:"submit",size:"large",children:"Login"})})]}))})})),C=n(747),N=n(123),k=n(74),w=n(764),M=n(761),L=n(755),E=n(750),T=n(772),A=n(751),J=n(754),P=n(758),U=n(759),_=n(223),q=n.n(_),z=(n(432),["#355ca9","#2196f2","#5571bc","#fe5722","#43555f","#8665b6","#009688","#febf0a","#e81f63","#06a9f3","#03bcd3","#fe9800","#feea3b","#ccdb3a","#8bc24b","#4baf50","#22828d","#3f51b5","#9c26b0","#673ab7","#607d8b","#9e9e9e","#795548"]),D=[].concat(z),V={},F=function(e){return V[e]||(V[e]=function(){var e=D.shift();return e||(e=(D=[].concat(z)).shift()),e}()),V[e]},G="SIGN_IN",B="SIGN_OUT",K="ON_MESSAGE",H="DELETE_MESSAGE",W="EDIT_MESSAGE",Y="RECALL_MESSAGE",$="ROOM",X="JOIN_ROOM",Z="ON_REPORT",Q="PRI_MESSAGE",ee="SETALLUSERS",te="EXIT_ROOM",ne=["Sexual Content","Violent or repulsive content","Spam or misleading"],se="broadcast",ae=n(122),re=n(298),ce=function(e){var t=e.message,n=e.onClickEdit,a=Object(x.c)(),r=t.id,c=t.text,o=t.time,i=t.sender,l=t.isRecalled,d=t.recallTime,u=t.received,j=Object(x.d)((function(e){return e.login.user})),b=Object(x.d)((function(e){return e.room.currentRoom})),m=(Object(x.d)((function(e){return e.room.userList})),Object(x.d)((function(e){return e.room})),Object(x.d)((function(e){return e.room.userList&&e.room.joinedRoom&&e.room.userList[e.room.joinedRoom.indexOf(b)]?e.room.userList[e.room.joinedRoom.indexOf(b)][0]:null}))),O=j===t.sender,p=j===m,g=i===m,y=Object(s.jsx)(J.a,{onClick:function(e){if(e&&e.key)switch(e.key){case"edit":n(t);break;case"delete":a({type:H,payload:{messageId:r,chatRoom:b}}),f.send(JSON.stringify({command:"deleteMessage",body:{messageId:r,chatRoom:b}}));break;case"recall":a({type:Y,payload:{messageId:r,chatRoom:b}}),f.send(JSON.stringify({command:"recallMessage",body:{messageId:r,chatRoom:b,recallTime:(new Date).getTime()}}))}},children:function(e,t){return t?["edit","delete","recall"]:e?["delete"]:[]}(p,O).map((function(e){return Object(s.jsx)(J.a.Item,{children:e},e)}))});return Object(s.jsxs)(N.a,{children:[Object(s.jsx)(k.a,{span:1,className:"avatar-container",children:Object(s.jsx)(P.a,{style:{backgroundColor:F(i),verticalAlign:"middle"},size:"large",gap:1,children:function(e){return e.split("_").map((function(e){return e[0]}))}(i)})}),Object(s.jsx)(k.a,{span:23,children:Object(s.jsxs)(N.a,{className:"".concat(null!==r&&void 0!==r?r:""," message-wrapper"),onMouseEnter:function(){var e=document.getElementById("".concat(r,"-dropdown"));e&&(e.style.visibility="visible",e.style.opacity="1")},onMouseLeave:function(){var e=document.getElementById("".concat(r,"-dropdown"));e&&(e.style.visibility="hidden",e.style.opacity="0")},children:[Object(s.jsxs)(k.a,{span:22,children:[Object(s.jsxs)(N.a,{className:"message-header",children:[Object(s.jsxs)(k.a,{className:"message-sender",children:[O?"ME":i," ",g&&" (admin)"]}),Object(s.jsxs)(k.a,{className:"message-time",children:[!l&&q()(o).format("ddd MMM DD hh:mm:ss"),u&&" (received)"]})]}),Object(s.jsx)(N.a,{children:Object(s.jsx)(k.a,{className:"message-text",children:Object(s.jsx)(ae.b,{content:!l&&c||function(e,t){return"******* This message was recalled at ".concat(q()(t).format("MMM DD hh:mm")," *******")}(0,d),matchers:[new re.a("url")]})})})]}),Object(s.jsx)(k.a,{span:2,id:"".concat(r,"-dropdown"),className:"message-dropdown",children:!l&&(O||p)&&Object(s.jsx)(U.a,{overlay:y,placement:"bottomLeft",children:Object(s.jsx)(h.a,{children:"..."})})})]})})]})},oe=(n(439),function(e){return!e.toLowerCase().includes("hate")}),ie=O.a.TextArea,le=function(e){var t=e.inputMessages,n=Object(x.c)(),r=Object(x.d)((function(e){return e.login.user})),c=Object(x.d)((function(e){return e.room.currentRoom})),o=Object(a.useState)(!1),i=Object(d.a)(o,2),l=i[0],u=i[1],j=Object(a.useState)(""),b=Object(d.a)(j,2),m=b[0],O=b[1],p=function(){u(!1);var e=document.getElementById("editMessageTextArea");if(oe(e.value)){var t={messageId:m.id,chatRoom:c,editedText:e.value};n({type:W,payload:t}),f.send(JSON.stringify({command:"editMessage",body:t}))}else f.send(JSON.stringify({command:"ban",body:{username:r.trim(),room:c.trim(),source:se}}))},h=function(e){O(e),u(!0)};return Object(s.jsxs)("article",{id:"chat-messages",children:[t&&t.map((function(e){return Object(s.jsx)(N.a,{className:"message",children:Object(s.jsx)(ce,{message:e,onClickEdit:h})})})),Object(s.jsx)(A.a,{title:"Edit Message",visible:l,onOk:p,onCancel:function(){return u(!1)},children:Object(s.jsx)(ie,{id:"editMessageTextArea",rows:4,showCount:!0,defaultValue:null===m||void 0===m?void 0:m.text,onPressEnter:p})})]})},de=n(312),ue=(n(448),n(756)),je=(n(449),n(306)),be=n(766),me=O.a.TextArea,Oe=function(){var e=Object(x.c)(),t=Object(x.d)((function(e){return e.login.user})),n=Object(x.d)((function(e){return e.room.currentRoom})),r=Object(a.useState)(""),c=Object(d.a)(r,2),o=c[0],i=c[1],u=function(e){e.preventDefault(),o&&(oe(o)?j():f.send(JSON.stringify({command:"ban",body:{username:t.trim(),room:n.trim(),source:se}})),i(""))},j=function(){var s={chatRoom:n,text:o,id:ue.a(),time:(new Date).getTime(),sender:t};e({type:K,payload:Object(l.a)(Object(l.a)({},s),{},{received:!0})}),f.send(JSON.stringify({command:"broadcast",body:s}))},b=Object(a.useState)(!1),m=Object(d.a)(b,2),O=m[0],p=m[1],g=Object(s.jsx)(je.a,{set:"twitter",perLine:12,include:["smileys","people"],onSelect:function(e){i(o+e.native)}});return Object(s.jsxs)("div",{id:"compose",children:[Object(s.jsx)(N.a,{children:Object(s.jsx)(me,{allowClear:!0,id:"compose-textarea",rows:4,value:o,showCount:!0,onPressEnter:u,onChange:function(e){i(e.target.value)}})}),Object(s.jsxs)(M.b,{style:{float:"right"},children:[Object(s.jsx)(de.a,{content:g,trigger:"click",visible:O,onVisibleChange:function(){p(!O)},children:Object(s.jsx)(h.a,{children:Object(s.jsx)(be.a,{})})}),Object(s.jsx)(h.a,{onClick:u,children:"Send"})]})]})},pe=(n(450),C.a.Content),he=C.a.Footer,ge=(C.a.Header,function(e){var t=e.chatRoom,n=Object(x.d)((function(e){return e.message.messages}));return Object(s.jsx)("div",{id:"chat-area",children:Object(s.jsxs)(C.a,{children:[Object(s.jsx)(pe,{children:Object(s.jsx)(le,{inputMessages:n[t]})}),Object(s.jsx)(he,{children:Object(s.jsx)(Oe,{})})]})})}),fe=n(762),xe=n(767),ye={labelCol:{span:8},wrapperCol:{span:16}},ve={required:"${label} is required!"},Se=function(e){for(var t=[],n=["Traveling","Reading","Music","Sports","Movies","Games"],r=u.a.Option,c=e.visible,o=e.setVisible,i=Object(a.useState)(!0),b=Object(d.a)(i,2),m=b[0],p=b[1],g=0;g<6;g++)t.push(Object(s.jsx)(r,{value:n[g],children:n[g]}));return Object(s.jsxs)(de.a,{placement:"rightTop",title:"Create Room",content:Object(s.jsxs)(j.a,Object(l.a)(Object(l.a)({},ye),{},{name:"nest-messages",onFinish:function(e){f.send(JSON.stringify({command:"createRoom",body:{name:e.name,interests:e.interest,isPrivate:e.switch||!1}})),o(!1)},validateMessages:ve,style:{outerWidth:"500"},children:[Object(s.jsx)(j.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Name is required!"},{pattern:/^[a-zA-Z0-9_]{1,20}$/,message:"Name should be 1-20 alphanumeric characters or underscores"}],children:Object(s.jsx)(O.a,{})}),Object(s.jsx)(j.a.Item,{name:"switch",label:"Private",valuePropName:"checked",children:Object(s.jsx)(fe.a,{onClick:function(){p((function(e){return!e}))}})}),Object(s.jsx)(j.a.Item,{name:"interest",label:"Interests",rules:[{required:!m}],children:Object(s.jsx)(u.a,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select",disabled:m,children:t})}),Object(s.jsx)(j.a.Item,{wrapperCol:Object(l.a)(Object(l.a)({},ye.wrapperCol),{},{offset:8}),children:Object(s.jsx)(h.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})),trigger:"click",visible:c,onVisibleChange:function(e){o(e)},children:[Object(s.jsx)("span",{children:Object(s.jsx)(xe.a,{})}),"Create"]})},Re=n(763),Ie=n(768),Ce=J.a.SubMenu,Ne=function(e){var t=1,n=Object(x.c)(),a=e.joinedRooms,r=e.userList,c=e.userName,o=e.setReport,i=function(e,n,a){return e===c||e===a?null:c===a?Object(s.jsx)(m.a,{title:"Remove",children:Object(s.jsx)(h.a,{style:{marginLeft:"5px"},ghost:"true",size:"small",type:"primary",shape:"circle",onClick:function(){return function(e,t){f.send(JSON.stringify({command:"forceToLeave",body:{userName:e,roomName:t}}))}(e,n)},children:"R"},e+"remove"+t++)}):Object(s.jsx)(m.a,{title:"Report",children:Object(s.jsx)(h.a,{style:{marginLeft:"5px"},ghost:"true",size:"small",type:"primary",shape:"circle",onClick:function(){o({visible:!0,reportRoom:n,reportName:e})},children:"!"},e+"report"+t++)})},l=function(e){return e!==c?Object(s.jsxs)(m.a,{title:"Block",children:[" ",Object(s.jsx)(h.a,{ghost:"true",size:"small",type:"primary",shape:"circle",onClick:function(){return function(e){f.send(JSON.stringify({command:"block",body:{userName:e}}))}(e)},children:"B"},e+"block"+t++)]}):null},d=function(e){var t=e.key;n({type:X,payload:t})};return Object(s.jsx)(J.a,{mode:"inline",selectedKeys:[""],defaultOpenKeys:["joinedRooms"],children:Object(s.jsx)(Ce,{title:Object(s.jsxs)("span",{children:[Object(s.jsx)(Ie.a,{}),Object(s.jsx)("span",{children:"Joined Rooms"})]}),children:a.map((function(e,n){return Object(s.jsx)(Ce,{title:e,onTitleClick:d,children:r[n].map((function(e){var c=r[n][0]===e?"magenta":"green",o=r[n][0]===e?"Admin":"Member";return Object(s.jsxs)(J.a.Item,{children:[Object(s.jsx)(Re.a,{color:c,children:o}),e,i(e,a[n],r[n][0]),l(e)]},e+t++)}))},e)}))},"joinedRooms")})},ke=(n(769),J.a.SubMenu,n(770)),we=function(){return Object(s.jsx)(J.a,{mode:"inline",selectedKeys:[""],onClick:function(){f.send(JSON.stringify({command:"exitAllRoom",body:{}}))},children:Object(s.jsxs)(J.a.Item,{children:[Object(s.jsx)("span",{children:Object(s.jsx)(ke.a,{})}),"Exit All"]})})},Me=n(771),Le=J.a.SubMenu,Ee=function(e){var t=e.allRooms,n=e.isPublic;return Object(s.jsx)(J.a,{mode:"inline",onClick:function(e){var t;t=e,f.send(JSON.stringify({command:"joinRoom",body:{name:t.key}}))},defaultOpenKeys:["allRooms"],children:Object(s.jsx)(Le,{title:Object(s.jsxs)("span",{children:[Object(s.jsx)(Ie.a,{}),Object(s.jsx)("span",{children:"All Rooms"})]}),children:t.map((function(e,t){return Object(s.jsx)(J.a.Item,{children:Object(s.jsxs)("span",{children:["false"===n[t]?Object(s.jsx)("span",{children:Object(s.jsx)(Me.a,{})}):null,e]})},e)}))},"allRooms")})},Te=n(753),Ae=(n(451),function(e){var t=Object(a.useState)(void 0),n=Object(d.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),i=Object(d.a)(o,2),u=i[0],j=i[1],b=Object(a.useState)(!0),m=Object(d.a)(b,2),p=m[0],h=m[1],g=e.report,x=e.setReport;return Object(s.jsx)("div",{children:Object(s.jsxs)(A.a,{title:"Report",visible:g.visible,onOk:function(){x(Object(l.a)(Object(l.a)({},g),{},{visible:!1})),f.send(JSON.stringify({command:"report",body:{reportedUsername:g.reportName,reportedReason:u,reportedRoom:g.reportRoom}}))},onCancel:function(){x(Object(l.a)(Object(l.a)({},g),{},{visible:!1}))},okButtonProps:{disabled:p},children:[Object(s.jsx)("p",{children:"Please Choose Your Reasons"}),Object(s.jsxs)(Te.a.Group,{class:"radio-group",onChange:function(e){console.log("radio checked",e.target.value),h(!1),c(e.target.value),3!==e.target.value&&j(ne[e.target.value])},value:r,children:[Object(s.jsx)(Te.a,{class:"radio-option",value:0,children:ne[0]}),Object(s.jsx)(Te.a,{class:"radio-option",value:1,children:ne[1]}),Object(s.jsx)(Te.a,{class:"radio-option",value:2,children:ne[2]}),Object(s.jsxs)(Te.a,{class:"radio-option",value:3,children:["More...",3===r?Object(s.jsx)(O.a,{style:{width:100,marginLeft:10},onChange:function(e){console.log("input",e.target.value),3===r&&j(e.target.value)}}):null]})]})]})})}),Je=Object(x.b)((function(e,t){return{reportStore:e.report}}),{})((function(e){var t=e.reportStore,n=t.isReportAdminVisible,r=t.reportedReason,c=t.reportedUsername,o=t.reportedRoom,i=Object(a.useState)(!1),l=Object(d.a)(i,2),u=l[0],j=l[1];Object(a.useEffect)((function(){j(n)}),[e.reportStore]);return Object(s.jsx)("div",{children:Object(s.jsxs)(A.a,{title:"Handle Report Message",visible:u,onOk:function(e){j(!1),f.send(JSON.stringify({command:"ban",body:{username:c.trim(),room:o.trim(),source:"report"}}))},onCancel:function(e){j(!1)},okText:"Approve",cancelText:"Disapprove",children:[Object(s.jsxs)("p",{children:["Reported User: ",c]}),Object(s.jsx)("p",{children:r})]})})})),Pe=Object(x.b)((function(e,t){return{room:e.room}}),{})((function(e){var t=e.room,n=Object(a.useState)([]),r=Object(d.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)((function(){return[[]]})),l=Object(d.a)(i,2),u=l[0],j=l[1],b=Object(a.useState)((function(){return[]})),m=Object(d.a)(b,2),O=m[0],p=m[1],h=Object(a.useState)(!1),g=Object(d.a)(h,2),f=g[0],x=g[1],y=Object(a.useState)(),S=Object(d.a)(y,2),R=S[0],I=S[1],C=Object(a.useState)((function(){return[]})),N=Object(d.a)(C,2),k=N[0],w=N[1],M=Object(a.useState)({visible:!1,reportRoom:null,reportName:null}),L=Object(d.a)(M,2),E=L[0],T=L[1];return Object(a.useEffect)((function(){null==t.msg?(t.joinedRoom&&o(t.joinedRoom),t.userList&&j(t.userList),t.allRooms&&p(t.allRooms),t.userName&&I(t.userName),t.isPublic&&w(t.isPublic)):"err"===t.type?v.error(t.msg):"info"===t.type?v.info(t.msg):v.success(t.msg)}),[t]),Object(s.jsxs)(J.a,{mode:"inline",onClick:function(e){"create"===e.key&&x(!0)},selectedKeys:[""],defaultOpenKeys:["allRooms","joinedRooms"],children:[Object(s.jsx)(J.a.Item,{children:Object(s.jsx)(Se,{visible:f,setVisible:x})},"create"),Object(s.jsx)(we,{}),Object(s.jsx)(Ne,{joinedRooms:c,userList:u,userName:R,setReport:T}),Object(s.jsx)(Ee,{allRooms:O,isPublic:k}),Object(s.jsx)(Ae,{report:E,setReport:T}),Object(s.jsx)(Je,{})]})})),Ue=function(e){var t=Object(a.useState)(""),n=Object(d.a)(t,2),r=n[0],c=n[1],o=e.userName,i=e.visible,l=e.setVisible,u=O.a.TextArea,j=Object(x.d)((function(e){return e.login.user}));return Object(s.jsx)(A.a,{title:"To ".concat(o),visible:i,onOk:function(){oe(r)?f.send(JSON.stringify({command:"privateMessage",body:{name:o,info:r}})):f.send(JSON.stringify({command:"ban",body:{username:j.trim(),room:null,source:"privateMsg"}})),c(""),l(!1)},onCancel:function(){c(""),l(!1)},children:Object(s.jsx)(u,{value:r,onChange:function(e){var t=e.target.value;c(t)}})})},_e=function(e){var t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),i=Object(d.a)(o,2),l=i[0],u=i[1],j=Object(x.d)((function(e){return e.userList.allUserList})),b=Object(x.d)((function(e){return e.login.user}));return console.log(b),Object(s.jsxs)("div",{children:[Object(s.jsx)(Ue,{userName:l,visible:r,setVisible:c}),Object(s.jsx)(E.b,{style:{width:"100%",height:"100%",position:"absolute",overflow:"auto"},itemLayout:"horizontal",dataSource:j,renderItem:function(e){return Object(s.jsxs)(E.b.Item,{style:{padding:"15px"},children:[Object(s.jsx)(E.b.Item.Meta,{avatar:Object(s.jsx)(P.a,{style:{backgroundColor:F(e.name),verticalAlign:"middle"},size:"large",gap:1,children:(t=e.name,t.split("_").map((function(e){return e[0]})))}),description:e.name,title:e.school}),e.name!=b?Object(s.jsx)(h.a,{type:"primary",shape:"round",size:"small",onClick:function(){u(e.name),c(!0)},children:"Chat!"}):Object(s.jsx)(h.a,{type:"primary",shape:"round",size:"small",disabled:!0,children:"Chat!"})]});var t}})]})},qe=Object(x.b)((function(e,t){return{rooms:e.room}}),{})((function(e){var t=e.selectedChatRoom,n=e.rooms,r=Object(a.useState)(""),c=Object(d.a)(r,2),o=c[0],i=c[1],l=Object(a.useState)([]),u=Object(d.a)(l,2),j=(u[0],u[1]),b=Object(x.d)((function(e){return e.login.user})),m=Object(a.useState)(!1),p=Object(d.a)(m,2),g=p[0],y=p[1];Object(a.useEffect)((function(){null==n.msg&&n.joinedRoom&&j(n.joinedRoom)}),[n]);var v=Object(s.jsxs)(M.b,{align:"center",children:[Object(s.jsx)(O.a,{placeholder:"Username",onChange:function(e){i(e.target.value)}}),Object(s.jsx)(h.a,{type:"primary",onClick:function(){return e=t,n=o,y(!1),void(null!=e&&null!=n&&f.send(JSON.stringify({command:"invite",body:{currentUser:b,inviteUserName:n,invitedRoom:e}})));var e,n},children:"Invite"})]});return Object(s.jsx)(de.a,{content:v,title:"Invite your friend!",trigger:"click",visible:g,onVisibleChange:function(e){y(e)},children:Object(s.jsx)(h.a,{children:"Invite"})})})),ze=(n(459),C.a.Header),De=C.a.Content,Ve=C.a.Footer,Fe=C.a.Sider,Ge=Object(x.b)((function(e,t){return{logIn:e.login,priMsg:e.priMessage}}),{})((function(e){Object(i.g)(),e.dispatch,e.logIn;var t,n=e.priMsg,r=Object(x.d)((function(e){return e.room.currentRoom})),c=Object(a.useState)(!1),o=Object(d.a)(c,2),l=o[0],u=o[1],j=Object(a.useState)(!1),b=Object(d.a)(j,2),m=b[0],O=b[1],p=Object(x.c)(),g=Object(a.useState)(""),y=Object(d.a)(g,2),S=y[0],R=y[1],I=Object(x.d)((function(e){return e.room.userList&&e.room.joinedRoom?e.room.userList[e.room.joinedRoom.indexOf(r)]:null})),A=Object(x.d)((function(e){return e.login.user})),J=Object(x.d)((function(e){return e.userList.allUserList})).find((function(e){return e.name===A}));if(void 0!=J){for(var P="",U=0;U<J.interest.length;U++)U>0&&(P+=", "),P+=J.interest[U];t=[{title:"Name",description:J.name},{title:"Age",description:J.age},{title:"School",description:J.school},{title:"Interests",description:P}]}var _=function(e,t){return Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{className:"message",children:e}),Object(s.jsx)("div",{className:"message",children:Object(s.jsx)(h.a,{onClick:function(){return q(t)},children:"Reply"})})]})},q=function(e){R(e),u(!0)};return Object(a.useEffect)((function(){null!==n.message?w.a.info({message:"".concat(n.sender," sends you a message"),description:_(n.message.info,n.sender),duration:5,styles:{paddingTop:"10px"}}):null!==n.feedback&&(n.feedback.indexOf("Sorry")<0?v.success(n.feedback):v.error(n.feedback))}),[n]),Object(s.jsxs)(C.a,{style:{height:"100vh"},children:[Object(s.jsx)(Ue,{userName:S,visible:l,setVisible:u}),Object(s.jsx)(Fe,{width:"300px",theme:"light",style:{overflowY:"auto"},children:Object(s.jsx)(Pe,{})}),Object(s.jsxs)(C.a,{style:{overFlow:"hidden"},children:[Object(s.jsxs)(ze,{style:{padding:0,backgroundColor:"white"},children:[r&&Object(s.jsx)("span",{id:"chat-area-header-room-name",style:{fontSize:"larger",fontWeight:"bolder"},children:r||""}),r&&Object(s.jsx)("span",{id:"chat-area-header-user-count",style:{fontSize:"medium",marginLeft:"20px"},children:I&&"(".concat(I.length,")")||""}),Object(s.jsxs)(M.b,{style:{float:"right"},size:"middle",children:[Object(s.jsx)("div",{children:null!=r?Object(s.jsxs)(s.Fragment,{children:[" ",Object(s.jsx)(h.a,{className:"exitButton",onClick:function(){p({type:te,payload:null}),f.send(JSON.stringify({command:"exitRoom",body:{name:r}}))},children:"Exit"}),Object(s.jsx)(qe,{selectedChatRoom:r})," "]}):null}),Object(s.jsx)(h.a,{type:"primary",shape:"circle",icon:Object(s.jsx)(T.a,{}),onClick:function(){O(!0)}}),Object(s.jsxs)(L.a,{title:"User Profile",placement:"left",closable:!1,onClose:function(){O(!1)},visible:m,children:[Object(s.jsx)(E.b,{itemLayout:"horizontal",dataSource:t,renderItem:function(e){return Object(s.jsx)(E.b.Item,{children:Object(s.jsx)(E.b.Item.Meta,{title:e.title,description:e.description})})}}),Object(s.jsx)(h.a,{type:"primary",shape:"round",size:"small",onClick:function(){f.send(JSON.stringify({command:"logout",body:{}}))},children:"Logout"})]})]})]}),Object(s.jsx)(De,{style:{margin:"24px 16px 0"},children:Object(s.jsxs)(N.a,{style:{height:"100%"},children:[Object(s.jsx)(k.a,{span:17,children:Object(s.jsx)("div",{className:"site-layout-background",style:{minHeight:360,height:"100%"},children:r&&Object(s.jsx)(ge,{chatRoom:r})})}),Object(s.jsx)(k.a,{span:7,style:{borderLeft:"2px solid rgba(0, 0, 0, 0.06)"},children:_e()})]})}),Object(s.jsx)(Ve,{style:{textAlign:"center"},children:"Chat App \xa92020 Created by Sammy the Owl"})]})]})})),Be=n(302),Ke=(n(225),0),He=n(18),We=Object(x.b)((function(e){return{logInStore:e.login}}),{})((function(e){var t=e.component,n=Object(He.a)(e,["component"]);return Object(s.jsx)(i.b,Object(l.a)(Object(l.a)({},n),{},{render:function(){return n.logInStore.isSignedIn?Object(s.jsx)(t,{}):Object(s.jsx)(i.a,{to:{pathname:"/"}})}}))})),Ye=Object(Be.a)(),$e=Object(x.b)((function(e,t){return{message:e.message}}),{onMessage:function(e){return function(t){var n=JSON.parse(e.data);switch(n.section){case"login":"err"===n.type?t({type:G,payload:{mesId:Ke++,isSignedIn:!1,user:null,msg:n.msg}}):t({type:G,payload:{mesId:Ke++,isSignedIn:!0,user:n.msg,msg:n.msg}});break;case"logout":t({type:B,payload:{mesId:Ke++,isSignedIn:!1,user:null,msg:n.msg}});break;case"room":t({type:$,payload:{request:n.request,type:n.type,msg:n.msg,param1:n.param1,param2:n.param2,param3:n.param3,param4:n.param4,param5:n.param5}});break;case"report":var s=JSON.parse(n.msg);t({type:Z,payload:{reportedUsername:s.reportedUsername,reportedReason:s.reportedReason,reportedRoom:s.reportedRoom}});break;case"message":t({type:n.request,payload:JSON.parse(n.msg)});break;case"privateMessage":if("priMsg_feedback"===n.request){t({type:Q,payload:null,sender:null,feedback:n.msg});break}var a=n.request;t({type:Q,payload:JSON.parse(n.msg),sender:a,feedback:null});break;case"setallusers":t({type:ee,payload:JSON.parse(n.msg)})}}}})((function(e){e.dispatch,e.message;return f.onopen=function(){console.log("connected")},f.onmessage=function(t){console.log(t),e.onMessage(t)},f.onclose=function(){A.a.error({content:"Websocket disconnected, please reenter the chat app"})},Object(s.jsx)("div",{className:"App",children:Object(s.jsx)(o.a,{history:Ye,children:Object(s.jsxs)(i.d,{children:[Object(s.jsx)(i.b,{path:"/",exact:!0,component:I}),Object(s.jsx)(We,{path:"/chat",exact:!0,component:Ge})]})})})})),Xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,773)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),r(e),c(e)}))},Ze=n(97),Qe=n(303),et=(n(240),{isSignedIn:null,user:null,mesId:0,msg:null}),tt={messages:{}},nt={allUserList:[]},st=(n(742),{request:null,type:null,msg:null,currentRoom:null,joinedRoom:[],userList:[[]],allRooms:[],isPublic:[]}),at=function(e){return e?"[]"===e?[]:e.substring(1,e.length-1).split(", "):null},rt=function(e,t){if(t){if("[]"===t)return[];for(var n=at(e).length,s=[],a=t.substring(1,t.length-1),r=0;r<n;r++){var c=a.indexOf("["),o=a.indexOf("]"),i=a.substring(c+1,o).split(", ");s.push(i),a=a.substring(o+1)}return s}return null},ct={isReportAdminVisible:!1,reportedUsername:"",reportedReason:"",reportedRoom:""},ot={message:null,sender:null,feedback:null},it=Object(Ze.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return!0===t.payload.isSignedIn?Object(l.a)(Object(l.a)({},e),{},{isSignedIn:!0,user:t.payload.user,mesId:t.payload.mesId,msg:t.payload.msg}):Object(l.a)(Object(l.a)({},e),{},{isSignedIn:!1,user:null,mesId:t.payload.mesId,msg:t.payload.msg});case B:return Object(l.a)(Object(l.a)({},e),{},{isSignedIn:null,user:null,mesId:t.payload.mesId,msg:t.payload.msg});default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K:var n=e.messages,s=t.payload,a=s.id,r=s.text,c=s.time,o=s.sender,i=s.chatRoom,d=s.received;return n[i]||(n[i]=[]),n[i].push({id:a,text:r,time:c,sender:o,received:d}),Object(l.a)(Object(l.a)({},e),{},{messages:Object(l.a)({},n)});case H:var u=e.messages,j=t.payload,b=j.messageId,m=j.chatRoom,O=u[m].filter((function(e){return e.id!==b})),p=Object(l.a)({},u);return p[m]=O,Object(l.a)(Object(l.a)({},e),{},{messages:p});case Y:var h=e.messages,g=t.payload,f=g.messageId,x=g.chatRoom,y=g.recallTime,v=h[x].map((function(e){return e.id===f&&(e.isRecalled=!0,e.recallTime=y,e.text=""),e})),S=Object(l.a)({},h);return S[x]=v,Object(l.a)(Object(l.a)({},e),{},{messages:S});case W:var R=e.messages,I=t.payload,C=I.messageId,N=I.chatRoom,k=I.editedText,w=R[N].map((function(e){return e.id===C&&(e.text=k),e})),M=Object(l.a)({},R);return M[N]=w,Object(l.a)(Object(l.a)({},e),{},{messages:M});default:return e}},userList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:return console.log(t.payload),Object(l.a)(Object(l.a)({},e),{},{allUserList:t.payload});default:return e}},room:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:var n=e.currentRoom;return"[]"===t.payload.param1&&(n=null),{request:t.payload.request,type:t.payload.type,msg:t.payload.msg,joinedRoom:at(t.payload.param1)||e.joinedRoom,userList:rt(t.payload.param1,t.payload.param2)||e.userList,allRooms:at(t.payload.param3)||e.allRooms,userName:t.payload.param4||e.userName,isPublic:at(t.payload.param5)||e.isPublic,currentRoom:n};case X:case te:return Object(l.a)(Object(l.a)({},e),{},{msg:null,currentRoom:t.payload});default:return e}},report:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return Object(l.a)(Object(l.a)({},e),{},{isReportAdminVisible:!0,reportedReason:t.payload.reportedReason,reportedUsername:t.payload.reportedUsername,reportedRoom:t.payload.reportedRoom});default:return e}},priMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return Object(l.a)(Object(l.a)({},e),{},{sender:t.sender,message:t.payload,feedback:t.feedback});case B:return Object(l.a)(Object(l.a)({},e),ot);default:return e}}}),lt=(n(744),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ze.d),dt=Object(Ze.e)(it,lt(Object(Ze.a)(Qe.a)));c.a.render(Object(s.jsx)(x.a,{store:dt,children:Object(s.jsx)($e,{})}),document.getElementById("root")),Xe()}},[[745,1,2]]]);
//# sourceMappingURL=main.50ab5f2d.chunk.js.map